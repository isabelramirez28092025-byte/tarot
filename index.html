<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tarot y Energ√≠as</title>
  <style>
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background: linear-gradient(to bottom, #1e0033, #000);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    header {
      text-align: center;
      padding: 1.5rem;
    }

    header img {
      /* CAMBIO REALIZADO AQU√ç: Aumentamos el tama√±o */
      width: 150px;
      height: 150px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 0 15px #a855f7;
    }

    header h1 {
      margin: 1rem 0 0.5rem;
      font-size: 1.8rem;
      color: #e0b3ff;
    }

    header p {
      font-size: 0.95rem;
      color: #ddd;
      max-width: 330px;
      margin: auto;
      line-height: 1.5rem;
    }

    main {
      text-align: center;
      padding: 1rem;
      max-width: 350px;
    }

    .buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 2rem;
      gap: 10px;
    }

    .btn {
      flex: 1;
      padding: 0.8rem;
      border: none;
      border-radius: 30px;
      font-size: 1rem;
      cursor: pointer;
      color: white;
      background: #8338ec;
      transition: background 0.3s;
    }

    .btn:hover {
      background: #a855f7;
    }

    /* Chat bubble */
    .chat-icon {
      position: fixed;
      /* CAMBIO 1 DE CSS: Aumentamos el valor de 'bottom' para subir el √≠cono */
      bottom: 70px; 
      right: 20px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #8338ec;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      animation: pulse 1.5s infinite;
      z-index: 1000;
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 5px #a855f7; }
      50% { box-shadow: 0 0 20px #a855f7; }
      100% { box-shadow: 0 0 5px #a855f7; }
    }

    /* Chat window */
    .chat-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: flex-end;
      align-items: flex-end;
      z-index: 999;
    }

    .chat-container {
      width: 360px;
      max-height: 500px;
      background: #1e0033;
      border: 1px solid #8338ec;
      border-radius: 15px;
      box-shadow: 0 0 15px rgba(131, 56, 236, 0.8);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      z-index: 1000;
    }

    .chat-header {
      background: #8338ec;
      padding: 10px;
      color: white;
      font-weight: bold;
      text-align: center;
      position: relative;
    }

    .chat-header .close-btn {
      position: absolute;
      right: 10px;
      top: 5px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1.2rem;
    }

    .chat-messages {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      font-size: 1rem;
      display: flex;
      flex-direction: column;
    }

    .chat-input {
      display: flex;
      /* Eliminamos 'flex-direction: row-reverse;' para que el bot√≥n est√© a la derecha por defecto */
      border-top: 1px solid #8338ec;
    }

    .chat-input input {
      flex: 1;
      padding: 12px;
      border: none;
      outline: none;
      font-size: 1rem;
      background: #250046;
      color: white;
    }

    .chat-input button {
      background: #8338ec;
      border: none;
      /* Aumentar el padding para hacerlo m√°s grande */
      padding: 12px 20px; 
      cursor: pointer;
      color: white;
      font-weight: bold;
      font-size: 1.2rem; /* Opcional: aumentar el √≠cono para que se vea m√°s grande */
    }

    .message {
      margin: 5px 0;
      padding: 10px 14px;
      border-radius: 15px;
      max-width: 80%;
      word-wrap: break-word;
    }

    .user {
      align-self: flex-end;
      background: #a855f7;
      color: white;
    }

    .bot {
      align-self: flex-start;
      background: #370055;
      color: #e0b3ff;
    }

    .option {
      background: #8338ec;
      color: white;
      padding: 8px 14px;
      border-radius: 20px;
      margin: 5px 0;
      cursor: pointer;
      font-size: 0.9rem;
      display: inline-block;
    }

    /* Mobile view */
    @media (max-width: 480px) {
      .chat-container {
        width: 95%;
        max-height: 75%;
      }
      .chat-messages {
        max-height: calc(100% - 60px);
      }
    }
  </style>
</head>
<body>
  <header>
    <img src="https://github.com/isabelramirez28092025-byte/tarot/blob/main/WhatsApp%20Image%202025-09-28%20at%201.00.07%20PM.jpeg?raw=true" alt="Perfil Tarot">
    <h1>Tarot & Energ√≠as</h1>
    <p>
      Me especializo en Terapias de Cristales de Cuarzo para la limpieza profunda del cuerpo, alma, esp√≠ritu y aura.  
      <br><br>
      üåü <b>Armonizaci√≥n de Chakras:</b> Alineando tus centros energ√©ticos.  
      ‚ú® <b>Limpieza Energ√©tica:</b> Disolviendo bloqueos y densidades.  
      üîÆ <b>Lecturas de Gu√≠a:</b> P√©ndulo (S√≠/No) y Tarot para ofrecer claridad en tu camino.  
    </p>
  </header>

  <main>
    <div class="buttons">
      <button class="btn" onclick="abrirChat()">Chatear Ahora</button>
      <button class="btn" onclick="abrirAgendar()">Agendar Cita</button>
    </div>
  </main>

  <div class="chat-icon" id="chatIcon" onclick="abrirChat()">üí¨</div>

  <div class="chat-overlay" id="chatOverlay" onclick="cerrarChat(event)">
    <div class="chat-container" onclick="event.stopPropagation()">
      <div class="chat-header">
        üîÆ Tarot Asistente
        <span class="close-btn" onclick="cerrarChat()">‚úñ</span>
      </div>
      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input">
        <input type="text" id="userInput" placeholder="Escribe tu mensaje...">
        <button onclick="sendMessage()">‚û§</button>
      </div>
    </div>
  </div>

  <script>
    const chatOverlay = document.getElementById('chatOverlay');
    const chatMessages = document.getElementById('chatMessages');
    const userInput = document.getElementById('userInput');
    // Obtenemos el nuevo ID del icono de chat
    const chatIcon = document.getElementById('chatIcon'); 

    let pasoAgendar = 0;
    let datosCliente = { nombre: "", apellido: "", pais: "", prefijo: "", telefono: "", mensaje: "" };

    const paises = {
      "Venezuela": "+58",
      "Colombia": "+57",
      "Argentina": "+54",
      "M√©xico": "+52",
      "Espa√±a": "+34",
      "Chile": "+56",
      "Per√∫": "+51",
      "Ecuador": "+593",
      "Estados Unidos": "+1"
    };

    function abrirChat() {
      chatOverlay.style.display = "flex";
      // Ocultamos el icono de chat al abrir
      chatIcon.style.display = "none"; 
      if (!chatMessages.hasChildNodes()) {
        mostrarMensaje("bot", "¬°Hola! Bienvenido/a. ¬øSobre qu√© te gustar√≠a hablar hoy?");
        mostrarOpciones();
      }
    }

    function abrirAgendar() {
      abrirChat();
      manejarOpcion("agendar");
    }

    function cerrarChat(event) {
      if (event && event.target === chatOverlay) {
        // Si se hace clic en el overlay, cerramos
        chatOverlay.style.display = "none";
        // Mostramos el icono de chat al cerrar
        chatIcon.style.display = "flex"; 
      } else if (!event || event.target.className === 'close-btn') {
        // Si se hace clic en el bot√≥n X, cerramos
        chatOverlay.style.display = "none";
        // Mostramos el icono de chat al cerrar
        chatIcon.style.display = "flex"; 
      }
      
      // Manejar el caso de cerrar sin evento (solo para limpieza, aunque ya se maneja arriba)
      if (!event) {
          chatOverlay.style.display = "none";
          chatIcon.style.display = "flex";
      }
    }

    function mostrarMensaje(remitente, texto) {
      const msg = document.createElement('div');
      msg.classList.add('message', remitente);
      msg.textContent = texto;
      chatMessages.appendChild(msg);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function mostrarOpciones() {
      const opciones = [
        { text: "üîÆ Hablar sobre el Tarot", action: "tarot" },
        { text: "üíé Precios de las sesiones", action: "precios" },
        { text: "‚ú® Terapias con cristales", action: "terapias" },
        { text: "üìø Lectura del p√©ndulo", action: "pendulo" },
        { text: "üìÖ Agendar una cita", action: "agendar" }
      ];
      opciones.forEach(op => {
        const btn = document.createElement('div');
        btn.classList.add('option');
        btn.textContent = op.text;
        btn.onclick = () => manejarOpcion(op.action);
        chatMessages.appendChild(btn);
      });
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function manejarOpcion(action) {
      if (action === "tarot") {
        mostrarMensaje("bot", `üìñ La lectura del Tarot es una herramienta de adivinaci√≥n y autoconocimiento que utiliza un mazo de cartas con simbolismo e im√°genes arquet√≠picas (como El Loco, La Muerte o La Torre).

No predice un futuro inmutable, sino que act√∫a como un espejo psicol√≥gico y espiritual. Al sacar y colocar las cartas en una tirada espec√≠fica, el lector interpreta el significado de los arcanos mayores y menores para:

‚ú® Evaluar el Presente: Comprender las energ√≠as, desaf√≠os y oportunidades actuales.
‚ú® Explorar Opciones: Mostrar posibles caminos y tendencias futuras.
‚ú® Fomentar la Introspecci√≥n: Dar perspectiva sobre miedos, motivaciones y potencial.

En esencia, el Tarot te ayuda a iluminar tu camino y comprender mejor tu vida.

¬øQuieres una lectura ahora? (s√≠/no)`);
        pasoAgendar = "tarot";
      } else if (action === "precios") {
        mostrarMensaje("bot", `üí≤ Lista de precios:
üîÆ Lectura de Tarot: 50$
üìø Lectura del P√©ndulo: 30$
üíé Terapia con Cristales: 30$

¬øDeseas agendar una cita? (s√≠/no)`);
        pasoAgendar = "precios";
      } else if (action === "terapias") {
        mostrarMensaje("bot", `üíé La Terapia con Cristales (o Cristaloterapia) es una pr√°ctica de bienestar hol√≠stico que utiliza piedras para interactuar con el campo energ√©tico del cuerpo.

Se cree que:
‚ú® Armonizan las energ√≠as inestables.
‚ú® Limpian bloqueos y densidades emocionales.
‚ú® Promueven la relajaci√≥n profunda y claridad mental.

En resumen, es una herramienta para fomentar el equilibrio energ√©tico interior. üíé‚ú®

¬øDeseas agendar una sesi√≥n? (s√≠/no)`);
        pasoAgendar = "terapias";
      } else if (action === "pendulo") {
        mostrarMensaje("bot", `üìø La Lectura con P√©ndulo se basa en la radiestesia, t√©cnica que detecta energ√≠as y responde preguntas r√°pidas de S√≠/No.

¬øC√≥mo funciona?
‚ú® Conexi√≥n con tu subconsciente.
‚ú® Amplificaci√≥n de micro-movimientos en tu mano.
‚ú® Respuestas claras programadas: S√≠ ‚û°Ô∏è giro horario / No ‚û°Ô∏è giro antihorario.

Se utiliza para:
‚úî Preguntas concretas de S√≠/No.
‚úî Diagn√≥stico energ√©tico de chakras.
‚úî Compatibilidad con personas o situaciones.

En resumen, el P√©ndulo es ideal para obtener claridad r√°pida y precisa. ‚ú®

¬øDeseas agendar una cita? (s√≠/no)`);
        pasoAgendar = "pendulo";
      } else if (action === "agendar") {
        pasoAgendar = 1;
        mostrarMensaje("bot", "Perfecto ‚ú® Empecemos tu cita. ¬øCu√°l es tu nombre?");
      }
    }

    function sendMessage() {
      const msg = userInput.value.trim();
      if (!msg) return;
      mostrarMensaje("user", msg);

      if (pasoAgendar === "tarot" || pasoAgendar === "precios" || pasoAgendar === "terapias" || pasoAgendar === "pendulo") {
        if (msg.toLowerCase() === "s√≠" || msg.toLowerCase() === "si") {
          pasoAgendar = 1;
          mostrarMensaje("bot", "Excelente ‚ú® Vamos a agendar. ¬øCu√°l es tu nombre?");
        } else if (msg.toLowerCase() === "no") {
          mostrarMensaje("bot", "¬øDeseas volver al inicio? (s√≠/no)");
          pasoAgendar = "volverInicio";
        }
      } else if (pasoAgendar === "volverInicio") {
        if (msg.toLowerCase() === "s√≠" || msg.toLowerCase() === "si") {
          chatMessages.innerHTML = "";
          abrirChat();
        } else {
          mostrarMensaje("bot", "¬°Gracias por tu visita! El chat se cerrar√°.");
          setTimeout(() => cerrarChat(), 2000);
        }
      } else if (pasoAgendar > 0) {
        if (pasoAgendar === 1) {
          datosCliente.nombre = msg;
          mostrarMensaje("bot", "Gracias üôè Ahora dime tu apellido.");
          pasoAgendar = 2;
        } else if (pasoAgendar === 2) {
          datosCliente.apellido = msg;
          mostrarMensaje("bot", "¬øDe qu√© pa√≠s escribes?");
          Object.keys(paises).forEach(p => {
            const btn = document.createElement('div');
            btn.classList.add('option');
            btn.textContent = p;
            btn.onclick = () => {
              datosCliente.pais = p;
              datosCliente.prefijo = paises[p];
              mostrarMensaje("user", p);
              mostrarMensaje("bot", `Perfecto. Para ${p}, escribe tu n√∫mero en este formato: SIN el prefijo ${datosCliente.prefijo}. Ejemplo: 4121234567`);
              pasoAgendar = 3;
            };
            chatMessages.appendChild(btn);
          });
          chatMessages.scrollTop = chatMessages.scrollHeight;
        } else if (pasoAgendar === 3) {
          datosCliente.telefono = msg;
          mostrarMensaje("bot", "Por √∫ltimo, escribe un mensaje breve con lo que buscas en tu cita.");
          pasoAgendar = 4;
        } else if (pasoAgendar === 4) {
          datosCliente.mensaje = msg;
          mostrarMensaje("bot", "¬°Gracias! Ahora te enviar√© a WhatsApp para confirmar tu cita. Por favor, verifica el mensaje antes de enviarlo.");
          
          // **********************************************
          // INICIO DE CORRECCI√ìN: Apertura directa de WhatsApp
          // **********************************************
          const numeroDestino = "584142078502";
          const texto = `Hola, quiero agendar una cita.\nNombre: ${datosCliente.nombre} ${datosCliente.apellido}\nPa√≠s: ${datosCliente.pais}\nTel√©fono: ${datosCliente.prefijo}${datosCliente.telefono}\nMensaje: ${datosCliente.mensaje}`;
          const url = `https://wa.me/${numeroDestino}?text=${encodeURIComponent(texto)}`;
          
          // Abrir WhatsApp de forma inmediata (sin setTimeout) para evitar bloqueos
          window.open(url, "_blank"); 
          
          pasoAgendar = "fin";
          setTimeout(() => {
            mostrarMensaje("bot", "¬øQuieres volver al inicio o salir?");
            const btnInicio = document.createElement('div');
            btnInicio.classList.add('option');
            btnInicio.textContent = "üîÑ Volver al inicio";
            btnInicio.onclick = () => { chatMessages.innerHTML = ""; abrirChat(); };
            chatMessages.appendChild(btnInicio);

            const btnSalir = document.createElement('div');
            btnSalir.classList.add('option');
            btnSalir.textContent = "‚ùå Salir";
            // Usamos la funci√≥n cerrarChat() para que el icono vuelva a aparecer
            btnSalir.onclick = () => cerrarChat(); 
            chatMessages.appendChild(btnSalir);
          }, 2000);
          // **********************************************
          // FIN DE CORRECCI√ìN
          // **********************************************
        }
      }
      userInput.value = '';
    }

    userInput.addEventListener("keypress", function(e) {
      if (e.key === "Enter") sendMessage();
    });
  </script>
</body>
</html>
